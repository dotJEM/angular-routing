(function(n,r,t){"use strict";function e(n,r){return g(new(g(function(){},{prototype:n})),r)}function a(n){return d(n)?n:n.$fullname||n.fullname}function o(n){var r,t=[];if(null===n)return t;for(;null!==(r=b.exec(n));)t.push({name:r[3]||r[9],converter:r[6]||"",args:r[8],index:r.index,lastIndex:b.lastIndex});return t}function i(){function n(n,r){var t=[];return v((n||"").split(":"),function(n,e){if(0==e)t.push(n);else{var a=n.match(/(\w+)(.*)/),o=a[1];t.push(r[o]),t.push(a[2]||""),delete r[o]}}),t.join("")}function r(r){var t=null;return function(e,a){return null===t&&(t=r?d(r)?function(t,e){var a=n(r,e.params);t.path(a).search(e.params).replace()}:function(n,t){n.url(r(t.pathParams,n.path(),n.search())).replace()}:function(){}),t(e,a)}}function a(n,r,t){var e;if(t&&(e=t.trim(),"{"===e[0]&&"}"===e[e.length-1]||"["===e[0]&&"]"===e[e.length-1]))try{t=angular.fromJson(e)}catch(a){}return{name:n,converter:function(){return h[r](t)}}}function i(n){return n.replace(b,"\\$&")}function u(n){var r="^",t="",e=[],u=0,c="",s={};return null===n?{name:null,params:s}:"/"===n?{exp:RegExp("^[/]?$",c),segments:[],name:t,params:s}:(v(o(n),function(o,c){var l="";r+=i(n.slice(u,o.index)),r+="/([^\\/]*)",""!==o.converter&&(l=":"+o.converter),t+=n.slice(u,o.index)+"/$"+c+l,s[o.name]={id:c,converter:o.converter},e.push(a(o.name,o.converter,o.args)),u=o.lastIndex}),r+=i(n.substr(u)),t+=n.substr(u),w||(t=t.toLowerCase(),c+="i"),"/"===r[r.length-1]&&(r=r.substr(0,r.length-1)),{exp:RegExp(r+"/?$",c),segments:e,name:t,params:s})}function c(n,r){return null==n?function(){}:function(n){var e,a=n.match(r.exp),o={};return a&&(e=!1,v(r.segments,function(n,r){var t,i;e||(t=a[r+1],i=n.converter()(t),l(i.accept)?(i.accept||(e=!0),o[n.name]=i.value):(i||(e=!0),o[n.name]=t))}),!e)?o:t}}var s=this,f={},h={},m={},w=!0;this.convert=function(n,r){return h[n]=r,s},this.when=function(n,t){var e=u(n);return f[e.name]={self:g({reloadOnSearch:!0},t),redirect:r(t.redirectTo),match:c(n,e),params:e.params,path:n},{convert:s.convert,when:s.when,otherwise:s.otherwise,decorate:s.decorate,ignoreCase:s.ignoreCase,matchCase:s.matchCase,$route:{name:e.name,params:$(e.params),path:n}}},this.otherwise=function(n){return s.when(null,n),s},this.decorate=function(n,r){return m[n]=r,s},this.ignoreCase=function(){return w=!1,s},this.matchCase=function(){return w=!0,s};var b=/[-\/\\^$*+?.()|[\]{}]/g;this.convert("num",function(){return function(n){var r=!isNaN(n);return{accept:r,value:r?Number(n):0}}}),this.convert("regex",function(n){var r,t,e="";if(p(n)&&l(n.exp))r=n.exp,l(n.flags)&&(e=n.flags);else{if(!(d(n)&&n.length>0))throw Error("The Regular-expression converter was not initialized with a valid object.");r=n}return t=RegExp(r,e),function(n){var r=t.test(n);return{accept:r,value:r?t.exec(n):null}}}),this.convert("",function(){return function(){return!0}}),this.$get=["$rootScope","$location","$q","$injector","$routeParams",function(r,a,o,i,u){function c(n,r,t){var a=e(n,{self:e(n.self,{params:g({},t,r),searchParams:t,pathParams:r})});return a}function s(n){var r,t;return v(f,function(e){!t&&(r=e.match(n))&&(t=c(e,r,a.search()))}),t||f[null]&&c(f[null],{},{})}function l(){var n=s(a.path()),e=d.current,c=n?n.self:t;if(!h&&c&&e&&angular.equals(c.pathParams,e.pathParams)&&!c.reloadOnSearch)e.params=n.params,$(c.params,u),r.$broadcast("$routeUpdate",e);else if(n||e){h=!1;var l=r.$broadcast("$routeChangeStart",c,e);if(!l.defaultPrevented){d.current=c,n&&n.redirect(a,c);var f=o.when(c);c&&v(m,function(n){f=f.then(function(){var r=i.invoke(n,c,{$next:c});return o.when(r)})}),f.then(function(){c===d.current&&(n&&angular.copy(c.params,u),r.$broadcast("$routeChangeSuccess",c,e))},function(n){c===d.current&&r.$broadcast("$routeChangeError",c,e,n)})}}}var h=!1,d={routes:f,reload:function(){h=!0,r.$evalAsync(l)},replace:function(r,t){r=n(r,t),a.path(r).search(t).replace()}};return r.$on("$locationChangeSuccess",l),d}]}function u(){function n(n){var r={handler:{}};return l(n.to)&&(r.to=n.to),l(n.from)&&(r.from=n.from),l(n.handler)&&(r.handler=n.handler),l(n.before)&&f(r.handler.before)&&(r.handler.before=n.before),l(n.between)&&f(r.handler.between)&&(r.handler.between=n.between),l(n.after)&&f(r.handler.after)&&(r.handler.after=n.after),r}function r(n,r){var e=t(n),a=t(r);if(!e||!a){if(e)throw Error("Invalid transition - to: '"+r+"'.");if(a)throw Error("Invalid transition - from: '"+n+"'.");throw Error("Invalid transition - from: '"+n+"', to: '"+r+"'.")}}function t(n){return"*"===n||i.test(n)?!0:!1}function e(n){for(var r=o,t=n.split("."),e="root"===t[0]?1:0;t.length>e;e++)t[e]in r.children||(r.children[t[e]]={children:{},targets:{}}),r=r.children[t[e]];return r}var o={children:{},targets:{}},i=/^\w+(\.\w+)*(\.[*])?$/,u=this;this.onEnter=function(r,t){if(p(t)){var e=n(t);this.transition(e.from||"*",r,e.handler)}else(h(t)||m(t))&&this.transition("*",r,t)},this.onExit=function(r,t){if(p(t)){var e=n(t);this.transition(r,e.to||"*",e.handler)}else(h(t)||m(t))&&this.transition(r,"*",t)},this.transition=function(n,t,o){var i,u=this;if(m(n))v(n,function(n){u.transition(n,t,o)});else if(m(t))v(t,function(r){u.transition(n,r,o)});else{if(n=a(n),t=a(t),t===n&&-1===t.indexOf("*"))return this;r(n,t),(angular.isFunction(o)||angular.isArray(o))&&(o={between:o}),i=e(n),t in i.targets||(i.targets[t]=[]),o.name=n+" -> "+t,i.targets[t].push(o)}return this},this.$get=["$q","$injector",function(n,r){function t(n,t){function e(e,a){var o;v(i,function(i){l(o=e(i))&&r.invoke(o,u,{$to:t,$from:n,$transition:a})})}var o=s(a(n)),i=c(o,a(t));return{before:function(n){e(function(n){return n.before},n)},between:function(n){e(function(n){return n.between},n)},after:function(n){e(function(n){return n.after},n)}}}function e(n){return"root"===n[0]&&n.splice(0,1),n}function i(n,r){for(var t,a,o=e(n.split(".")).reverse(),i=e(r.split(".")).reverse();;){if(t=o.pop(),a=i.pop(),"*"===a||"*"===t)return!0;if(t!==a)return!1;if(!l(t)||!l(a))return!0}return!0}function c(n,r){var t=[];return v(n,function(n){v(n.targets,function(n,e){i(e,r)&&v(n,function(n){t.push(n)})})}),t}function s(n){var r=o,t=n.split("."),e=[],a="root"===t[0]?1:0;do{if("*"in r.children&&e.push(r.children["*"]),!(t[a]in r.children))break;r=r.children[t[a]],e.push(r)}while(a++<t.length);return e}var f={root:o,find:t};return f}]}function c(){var n=RegExp("^(((http|https|ftp)://([\\w-\\d]+\\.)+[\\w-\\d]+){0,1}(/?[\\w~,;\\-\\./?%&+#=]*))","i");this.$get=["$http","$q","$injector","$templateCache",function(r,t,e,a){function o(n){return r.get(n,{cache:a}).then(function(n){return n.data})}function i(n){return t.when(e.invoke(n))}function u(n){if(l(n.url))return o(n.url);if(l(n.fn))return i(n.fn);if(l(n.html))return t.when(n.html);throw Error("Object must define url, fn or html.")}return this.get=function(r){if(d(r))return n.test(r)?o(r):t.when(r);if(h(r)||m(r))return i(r);if(p(r))return u(r);throw Error("Template must be either an url as string, function or a object defining either url, fn or html.")},this}]}function s(){this.$get=["$rootScope","$q","$template",function(n,r,e){function a(n){if("undefined"===n)throw Error("Must define a view name.")}function o(r){n.$broadcast("$viewUpdate",r)}function i(r,t){n.$broadcast("$viewRefresh",r,t)}function u(n,r){return r in n&&null!==n[r]}var c={},s=null;return this.clear=function(n){var r=this;if(f(n))v(c,function(n,t){r.clear(t)});else{if(s)return s.records[n]={act:"clear",fn:function(){r.clear(n)}},t;delete c[n],o(n)}},this.setOrUpdate=function(n,r,i){var l=this;return a(n),s?(s.records[n]={act:"setOrUpdate",fn:function(){l.setOrUpdate(n,r,i)}},t):(u(c,n)?(c[n].template=e.get(r),c[n].controller=i,c[n].version++):c[n]={template:e.get(r),controller:i,version:0},o(n),t)},this.setIfAbsent=function(n,r,i){var l=this;return a(n),s?(u(s.records,n)&&"clear"!==s.records[n].act||(s.records[n]={act:"setIfAbsent",fn:function(){l.setIfAbsent(n,r,i)}}),t):(u(c,n)||(c[n]={template:e.get(r),controller:i,version:0},o(n)),t)},this.get=function(n){return f(n)?c:c[n]},this.refresh=function(n,r){var e=this;if(f(n))v(c,function(n,r){e.clear(r)});else{if(s)return s.records[n]={act:"refresh",fn:function(){e.refresh(n,r)}},t;i(n,r)}},this.beginUpdate=function(){if(s)throw Error("Can't start multiple transactions");var n=s={records:{}};return{commit:function(){s=null,v(n.records,function(n){n.fn()})},cancel:function(){s=null}}},this}]}var l=angular.isDefined,f=angular.isUndefined,h=angular.isFunction,d=angular.isString,p=angular.isObject,m=angular.isArray,v=angular.forEach,g=angular.extend,$=angular.copy,w=angular.equals;angular.element;var b=RegExp("/((:(\\w+))|(\\{((\\w+)(\\((.*?)\\))?:)?(\\w+)\\}))","g");angular.module("ui.routing",[]),angular.module("ui.routing").provider("$route",i).value("$routeParams",{}),angular.module("ui.routing").provider("$stateTransition",u);var x=["$routeProvider","$stateTransitionProvider",function(n,r){function e(n){if(!$.test(n))throw Error("Invalid name: '"+n+"'.")}function o(r,t,e,a){var o;return l(a)||(a=!0),o=t||"",""!==o&&"/"===o[o.length-1]&&(o=o.substr(0,o.length-1)),"/"!==r[0]&&(o+="/"),o+=r,n.when(o,{state:e,reloadOnSearch:a})}function i(n){for(;l(n)&&!l(n.route);)n=n.parent;return n&&n.route.path||""}function u(n,t,e){var a=t.fullname+"."+n,c=t;l(t.children)||(t.children={}),n in t.children||(t.children[n]={}),t=t.children[n],t.self=g({},e,{$fullname:a}),t.fullname=a,t.parent=c,l(e.route)&&(t.route=o(e.route,i(c),a,e.reloadOnSearch).$route),l(e.onEnter)&&r.onEnter(a,e.onEnter),l(e.onExit)&&r.onExit(a,e.onExit),null===e.children?t.children={}:v(e.children,function(n,r){u(r,t,n)})}function c(n){for(var r=m,t="root"===n[0]?1:0;n.length>t;t++){if(!(n[t]in r.children))throw Error("Could not locate '"+n[t]+"' under '"+r.fullname+"'.");r=r.children[n[t]]}return r}function s(n){return c(n.split("."))}function h(n){var r=n.split("."),n=r.pop();return{at:c(r),name:n}}var m={fullname:"root",children:{},self:{$fullname:"root"}},$=/^\w+(\.\w+)*?$/;this.state=function(n,r){var t;return e(n),t=h(n),u(t.name,t.at,r),this},this.$get=["$rootScope","$q","$injector","$route","$view","$stateTransition","$location",function(n,r,e,o,i,u){function c(n){var r,e=n.match("^\\$node\\(([-+]?\\d+)\\)$"),a=S;if(e?a=h(Number(e[1]),a):(r=n.split("/"),v(r,function(n){a=$(n,a)})),a===m)throw Error("Path expression out of bounds.");return a&&g({},a.self)||t}function h(n,r){var t,e=[];for(v(r.parent.children,function(n){e.push(n),r.fullname===n.fullname&&(t=e.length-1)});0>n;)n+=e.length;return n=(t+n)%e.length,e[n]}function $(n,r){if("."===n){if(S!==r)throw Error("Invalid path expression. Can only define '.' i the beginning of an expression.");return r}if(".."===n){if(f(r.parent))throw Error("Path expression out of bounds.");return r.parent}if(""===n){if(S!==r)throw Error("Invalid path expression.");return m}var t=n.match("^\\[(-?\\d+)\\]$");if(t){var e=Number(t[1]),a=[];if(v(r.children,function(n){a.push(n)}),Math.abs(e)>=a.length)throw Error("Index out of bounds, index selecter must not exeed child count or negative childcount");return 0>e?a[a.length+e]:a[e]}if(n in r.children)return r.children[n];throw Error("Could find state for the lookup path.")}function b(r){l(r)?d(r)||p(r)?(P=a(r),0!==P.indexOf("root")&&(P="root."+P)):r&&(P=m.fullname):P=S.fullname,n.$evalAsync(function(){C(S,I,o.current)})}function x(n,r){function t(){var n={};return a.route&&v(a.route.params,function(t,e){n[e]=r[e]}),n}var e=[],a=n;do e.push({state:a,params:t()});while(a=a.parent);return e}function E(n,r,t,e){for(var a,o,i=x(n,t||{}),u=x(r,e),c=Math.max(i.length,u.length),s=0;c>s;s++)a=i[i.length-s-1],o=u[u.length-s-1],f(a)?o.changed=!0:f(o)?u[0].changed=!0:o.changed=P&&P==o.state.fullname?!0:o.state.fullname!==a.state.fullname?!0:w(o.params,a.params)?!1:!0;return u.reverse()}function C(e,o,c){var l,f,e=s(a(e)),h=g({},e.self,{$params:o,$route:c}),d=O.current,p=u.find(O.current,h),m=!1,$=E(s(a(O.current)),e,d.$params&&d.$params.all,o&&o.all||{}),w={cancel:function(){m=!0},"goto":function(n,r){m=!0,C(n,r)}};p.before(w),m||(l=n.$broadcast("$stateChangeStart",h,d),l.defaultPrevented||r.when(h).then(function(){var r=!1;return f=i.beginUpdate(),i.clear(),v($,function(n){n.changed&&(r=!0),v(n.state.self.views,function(n,t){r?i.setOrUpdate(t,n.template,n.controller):i.setIfAbsent(t,n.template,n.controller)})}),p.between(w),m?(f.cancel(),t):(S=e,I=o,O.current=h,f.commit(),n.$broadcast("$stateChangeSuccess",h,d),t)},function(r){f.cancel(),n.$broadcast("$stateChangeError",h,d,r)}).then(function(){m||(w.cancel=function(){throw Error("Can't cancel transition in after handler")},p.after(w))}))}var P=null,S=m,I={},O={root:m,current:g({},m.self),"goto":function(n,r){C(n,r)},lookup:c,reload:b};return n.$on("$routeChangeSuccess",function(){var n,r=o.current;r?(n={all:r.params,path:r.pathParams,search:r.searchParams},r.state&&C(r.state,n,r)):C(m)}),n.$on("$routeUpdate",function(){var n,r=o.current;r&&(n={all:r.params,path:r.pathParams,search:r.searchParams})}),O}]}];angular.module("ui.routing").provider("$state",x),angular.module("ui.routing").provider("$template",c),angular.module("ui.routing").provider("$view",s);var E=["$state","$anchorScroll","$compile","$controller","$view","$animator",function(n,r,t,e,a,o){return{restrict:"ECA",terminal:!0,link:function(n,i,u){function c(){d&&(d.$destroy(),d=null)}function s(n){n?g.leave(i.contents(),i):i.html(""),c()}function f(o){var u,c=a.get(p);if(c&&c.template){if(c.version===$)return;$=c.version,u=c.controller,c.template.then(function(a){s(o),o?g.enter(angular.element("<div></div>").html(a).contents(),i):i.html(a);var c=t(i.contents());d=n.$new(),u&&(u=e(u,{$scope:d}),i.contents().data("$ngControllerController",u)),c(d),d.$emit("$viewContentLoaded"),d.$eval(v),r()})}else s(o)}var d,p=u.uiView||u.name,m=l(u.ngAnimate),v=u.onload||"",g=o(n,u),$=-1;n.$on("$viewChanged",function(n,r){r===p&&f(m)}),n.$on("$viewRefresh",function(n,r,t){r===p&&(h(d.refresh)?d.refresh(t):d.broadCast("$refresh",r,t))}),n.$on("$stateChangeSuccess",function(){return f(m)}),f(!1)}}}];angular.module("ui.routing").directive("uiView",E)})(window,document);