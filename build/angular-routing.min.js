/**
 * @license dotJEM Angular Routing
 * (c) 2012-2013 dotJEM (Jens Melgaard)
 * License: MIT
 *
 * @module angular-routing
 */
var dotjem;(function(e,t,r,n){"use strict";function o(e,t){return y(new(y(function(){},{prototype:e})),t)}function a(e){return g(e)?e:e.$fullname||e.fullname}function i(e){if(v(e))return function(t,r){return t.invoke(e,e,r)};if(b(e)){var t=e[e.length-1];return function(r,n){return r.invoke(e,t,n)}}return null}function u(e,t,r){var n=x(e||{});return n.$path=x(t||{}),n.$search=x(r||{}),n}function c(e){var t=[];return w(e,function(e,r){t.push(l(r,!0)+(e===!0?"":"="+l(e,!0)))}),t.length?t.join("&"):""}function l(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function s(){function e(e){var t=null;return function(n,o){return null===t&&(t=e?g(e)?function(t,n){var o=r(e,n.params);t.path(o).search(n.params).replace()}:function(t,r){t.url(e(r.pathParams,t.path(),t.search())).replace()}:function(){}),t(n,o)}}function t(e,t,r){var n;if(r&&(n=r.trim(),"{"===n[0]&&"}"===n[n.length-1]||"["===n[0]&&"]"===n[n.length-1]))try{r=angular.fromJson(n)}catch(o){}return{name:e,converter:function(){return h[t](r)}}}function r(e,r){var n="",o=0;return w(i(e),function(a){var i=function(e){return""+e},u=t(a.name,a.converter,a.args).converter();!v(u)&&d(u.format)&&(i=u.format),n+=e.slice(o,a.index)+"/"+i(r[a.name]),o=a.lastIndex,delete r[a.name]}),n+=e.substr(o)}function a(e){return e.replace(b,"\\$&")}function i(e){var t,r=[];if(null===e)return r;for(;null!==(t=E.exec(e));)r.push({name:t[3]||t[9],converter:t[6]||"",args:t[8],index:t.index,lastIndex:E.lastIndex});return r}function u(e){var r="^",n="",o=[],u=0,c="",l={};return null===e?{name:null,params:l}:"/"===e?{exp:RegExp("^[/]?$",c),segments:[],name:n,params:l}:(w(i(e),function(i,c){var s="";r+=a(e.slice(u,i.index)),r+="/([^\\/]*)",""!==i.converter&&(s=":"+i.converter),n+=e.slice(u,i.index)+"/$"+c+s,l[i.name]={id:c,converter:i.converter},o.push(t(i.name,i.converter,i.args)),u=i.lastIndex}),r+=a(e.substr(u)),n+=e.substr(u),m||(n=n.toLowerCase(),c+="i"),"/"===r[r.length-1]&&(r=r.substr(0,r.length-1)),{exp:RegExp(r+"/?$",c),segments:o,name:n,params:l})}function l(e,t){return null==e?function(){}:function(e){var r,o=e.match(t.exp),a={};return o&&(r=!1,w(t.segments,function(e,t){var n,i,u;r||(n=o[t+1],u=e.converter(),!v(u)&&d(u.parse)&&(u=u.parse),i=u(n),d(i.accept)?(i.accept||(r=!0),a[e.name]=i.value):(i||(r=!0),a[e.name]=n))}),!r)?a:n}}var s=this,f={},h={},p={},m=!0;this.convert=function(e,t){return h[e]=t,s},this.when=function(t,r){var n=u(t);return f[n.name]={self:y({reloadOnSearch:!0},r),redirect:e(r.redirectTo),match:l(t,n),params:n.params,path:t},{convert:s.convert,when:s.when,otherwise:s.otherwise,decorate:s.decorate,ignoreCase:s.ignoreCase,matchCase:s.matchCase,$route:{name:n.name,params:x(n.params),route:t}}},this.otherwise=function(e){return s.when(null,e),s},this.decorate=function(e,t){return p[e]=t,s},this.ignoreCase=function(){return m=!1,s},this.matchCase=function(){return m=!0,s};var b=/[-\/\\^$*+?.()|[\]{}]/g,E=RegExp("/((:(\\w+))|(\\{((\\w+)(\\((.*?)\\))?:)?(\\w+)\\}))","g");this.convert("num",function(){return{parse:function(e){var t=!isNaN(e);return{accept:t,value:t?Number(e):0}},format:function(e){if(isNaN(e))throw Error(C.invalidNumericValue);return""+e}}}),this.convert("regex",function(e){var t,r,n="";if($(e)&&d(e.exp))t=e.exp,d(e.flags)&&(n=e.flags);else{if(!(g(e)&&e.length>0))throw Error(C.regexConverterNotValid);t=e}return r=RegExp(t,n),{parse:function(e){var t=r.test(e);return{accept:t,value:t?r.exec(e):null}},format:function(e){var t=""+e,n=r.test(t);if(!n)throw Error(C.valueCouldNotBeMatchedByRegex);return t}}}),this.convert("",function(){return function(){return!0}}),this.$get=["$rootScope","$location","$q","$injector","$routeParams",function(e,t,a,i,u){function l(e,t,r){var n=o(e,{self:o(e.self,{params:y({},r,t),searchParams:r,pathParams:t})});return n}function s(e){var r,n;return w(f,function(o){!n&&(r=o.match(e))&&(n=l(o,r,t.search()))}),n||f[null]&&l(f[null],{},{})}function h(){var r=s(t.path()),o=m.current,c=r?r.self:n;if(!d&&c&&o&&angular.equals(c.pathParams,o.pathParams)&&!c.reloadOnSearch)o.params=c.params,o.searchParams=c.searchParams,o.pathParams=c.pathParams,x(c.params,u),e.$broadcast("$routeUpdate",o);else if(r||o){d=!1;var l=e.$broadcast("$routeChangeStart",c,o);if(!l.defaultPrevented){m.current=c,r&&r.redirect(t,c);var f=a.when(c);c&&w(p,function(e){f=f.then(function(){var t=i.invoke(e,c,{$next:c});return a.when(t)})}),f.then(function(){c===m.current&&(r&&angular.copy(c.params,u),e.$broadcast("$routeChangeSuccess",c,o))},function(t){c===m.current&&e.$broadcast("$routeChangeError",c,o,t)})}}}var d=!1,m={routes:f,reload:function(){d=!0,e.$evalAsync(h)},change:function(e){var n=e.params||{},o=r(e.route,n),a=t.path(o).search(n||{});e.replace&&a.replace()},format:function(e,t){var t=t||{};return r(e,t)+c(t)}};return e.$on("$locationChangeSuccess",h),m}]}function f(){function e(e){var t={handler:{}};return d(e.to)&&(t.to=e.to),d(e.from)&&(t.from=e.from),d(e.handler)&&(t.handler=e.handler),d(e.before)&&m(t.handler.before)&&(t.handler.before=e.before),d(e.between)&&m(t.handler.between)&&(t.handler.between=e.between),d(e.after)&&m(t.handler.after)&&(t.handler.after=e.after),t}function t(e,t){var n=r(e),o=r(t);if(!n||!o){if(n)throw Error("Invalid transition - to: '"+t+"'.");if(o)throw Error("Invalid transition - from: '"+e+"'.");throw Error("Invalid transition - from: '"+e+"', to: '"+t+"'.")}}function r(e){return"*"===e||u.test(e)?!0:!1}function n(e){for(var t=o,r=e.split("."),n="root"===r[0]?1:0;r.length>n;n++)r[n]in t.children||(t.children[r[n]]={children:{},targets:{}}),t=t.children[r[n]];return t}var o={children:{},targets:{}},u=/^\w+(\.\w+)*(\.[*])?$/;this.onEnter=function(t,r){if($(r)){var n=e(r);this.transition(n.from||"*",t,n.handler)}else(v(r)||b(r))&&this.transition("*",t,r)},this.onExit=function(t,r){if($(r)){var n=e(r);this.transition(t,n.to||"*",n.handler)}else(v(r)||b(r))&&this.transition(t,"*",r)},this.transition=function(e,r,o){var u,c=this;if(b(e))w(e,function(e){c.transition(e,r,o)});else if(b(r))w(r,function(t){c.transition(e,t,o)});else{if(e=a(e),r=a(r),r===e&&-1===r.indexOf("*"))return this;t(e,r),i(o)&&(o={between:o}),u=n(e),r in u.targets||(u.targets[r]=[]),o.name=e+" -> "+r,u.targets[r].push(o)}return this},this.$get=["$q","$injector",function(e,t){function r(e,r){function n(n,o){var a;w(u,function(u){d(a=n(u))&&i(a)(t,{$to:r,$from:e,$transition:o})})}var o=l(a(e)),u=c(o,a(r));return{before:function(e){n(function(e){return e.before},e)},between:function(e){n(function(e){return e.between},e)},after:function(e){n(function(e){return e.after},e)}}}function n(e){return"root"===e[0]&&e.splice(0,1),e}function u(e,t){for(var r,o,a=n(e.split(".")).reverse(),i=n(t.split(".")).reverse();;){if(r=a.pop(),o=i.pop(),"*"===o||"*"===r)return!0;if(r!==o)return!1;if(!d(r)||!d(o))return!0}return!0}function c(e,t){var r=[];return w(e,function(e){w(e.targets,function(e,n){u(n,t)&&w(e,function(e){r.push(e)})})}),r}function l(e){var t=o,r=e.split("."),n=[],a="root"===r[0]?1:0;do{if("*"in t.children&&n.push(t.children["*"]),!(r[a]in t.children))break;t=t.children[r[a]],n.push(t)}while(a++<r.length);return n}var s={root:o,find:r};return s}]}function h(){var e=RegExp("^(((http|https|ftp)://([\\w-\\d]+\\.)+[\\w-\\d]+){0,1}(/?[\\w~,;\\-\\./?%&+#=]*))","i");this.$get=["$http","$q","$injector","$templateCache",function(t,r,n,o){function a(e){return t.get(e,{cache:o}).then(function(e){return e.data})}function i(e){return r.when(n.invoke(e))}function u(e){if(d(e.url))return a(e.url);if(d(e.fn))return i(e.fn);if(d(e.html))return r.when(e.html);throw Error("Object must define url, fn or html.")}var c={get:function(t){if(g(t))return e.test(t)?a(t):r.when(t);if(v(t)||b(t))return i(t);if($(t))return u(t);throw Error("Template must be either an url as string, function or a object defining either url, fn or html.")}};return c}]}function p(){this.$get=["$rootScope","$q","$template",function(e,t,r){function o(e){return $(e)&&(d(e.template)||d(e.controller)||d(e.locals)||d(e.sticky))}function a(e){if("undefined"===e)throw Error("Must define a view name.")}function i(t){e.$broadcast("$viewUpdate",t)}function u(t,r){e.$broadcast("$viewRefresh",t,r)}function c(e,t){return t in e&&null!==e[t]}var l={},s=null,f={};return f.clear=function(e){if(m(e))w(l,function(e,t){f.clear(t)});else{if(s)return s.records[e]={act:"clear",fn:function(){f.clear(e)}},n;delete l[e],i(e)}},f.setOrUpdate=function(e,t,h,p,m){var v=t;return o(t)&&(v=t.template,h=t.controller,p=t.locals,m=t.sticky),a(e),s?(s.records[e]={act:"setOrUpdate",fn:function(){f.setOrUpdate(e,v,h,p,m)}},n):(c(l,e)||(l[e]={version:-1}),l[e].template=r.get(v),l[e].controller=h,l[e].locals=p,d(m)&&g(m)&&l[e].sticky===m?u(e,{$locals:p,sticky:m}):(l[e].version++,l[e].sticky=m,i(e)),n)},f.setIfAbsent=function(e,t,u,h){var p=t;return o(t)&&(p=t.template,u=t.controller,h=t.locals),a(e),s?(c(s.records,e)&&"clear"!==s.records[e].act||(s.records[e]={act:"setIfAbsent",fn:function(){f.setIfAbsent(e,p,u,h)}}),n):(c(l,e)||(l[e]={template:r.get(p),controller:u,locals:h,version:0},i(e)),n)},f.get=function(e){return m(e)?l:l[e]},f.refresh=function(e,t){if(m(e))w(l,function(e,r){f.refresh(r,t)});else{if(s)return s.records[e]={act:"refresh",fn:function(){f.refresh(e,t)}},n;t.$locals=l[e]&&l[e].locals,u(e,t)}},f.beginUpdate=function(){if(s)throw Error("Can't start multiple transactions");var e=s={records:{}};return{commit:function(){s=null,w(e.records,function(e){e.fn()})},cancel:function(){s=null}}},f}]}angular.module("dotjem.routing",[]);var d=angular.isDefined,m=angular.isUndefined,v=angular.isFunction,g=angular.isString,$=angular.isObject,b=angular.isArray,w=angular.forEach,y=angular.extend,x=angular.copy,E=angular.equals;angular.element;var C={routeCannotBeUndefined:"Can not set route to undefined.",valueCouldNotBeMatchedByRegex:"Value could not be matched by the regular expression parameter.",regexConverterNotValid:"The Regular-expression converter was not initialized with a valid object.",invalidNumericValue:"Value was not acceptable for a numeric parameter.",invalidBrowserPathExpression:"Invalid path expression.",expressionOutOfBounds:"Expression out of bounds.",couldNotFindStateForPath:"Could find state for path."};angular.module("dotjem.routing").provider("$route",s).value("$routeParams",{}),angular.module("dotjem.routing").provider("$stateTransition",f);var O=["$routeProvider","$stateTransitionProvider",function(e,t){var r=new k(e,t),o=r.createState("root",{}),c=new R(o),l=new _;this.state=function(e,t){A.validateName(e);var n=c.lookup(e,1);return n.add(r.createState(e,t,n)),this},this.$get=["$rootScope","$q","$injector","$route","$view","$stateTransition","$location","$scroll","$resolve",function(e,t,r,s,f,h,p,m,v){function b(t){d(t)?g(t)||$(t)?(O=a(t),0!==O.indexOf("root")&&(O="root."+O)):t&&(O=o.fullname):O=j.fullname,e.$evalAsync(function(){E({state:j,params:S,route:s.current})})}function x(t,r,n){P.params=u(t,r,n);var o=P.current.$params;o.all=t,o.path=r,o.search=n,e.$broadcast("$stateUpdate",P.current)}function E(o){var p,$,b=o.params,C=o.route,R=c.lookup(a(o.state)),_=y({},R.self,{$params:b,$route:C}),k=P.current,A=h.find(P.current,_),N=l.compare(c.lookup(a(P.current)),R,k.$params&&k.$params.all,b&&b.all||{},O),B=new U(E);if(!O&&!N.stateChanges)return N.paramChanges&&x(b.all||{},b.path||{},b.search||{}),n;if(O=null,o.updateroute&&R.route){var I={},T=k.$params&&k.$params.all||{};w(R.route.params,function(e,t){t in T&&(I[t]=T[t])});var V=y(I,b&&b.all);return s.change(y({},R.route,{params:V})),n}A.before(B),B.canceled||e.$broadcast("$stateChangeStart",_,k).defaultPrevented||t.when(_).then(function(){var o=!1,a={};p=f.beginUpdate(),f.clear();var c=t.when(0);return w(N.array,function(e){c=c.then(function(){return(o=e.isChanged||o)&&v.clear(e.state.resolve),v.all(e.state.resolve,a)}).then(function(t){a=y({},a,t),$=e.state.scrollTo,w(e.state.views,function(t,n){var u,c;(u=t.sticky)&&((c=i(u))?u=c(r,{$to:_,$from:k}):g(u)||(u=e.state.fullname)),o||d(u)?f.setOrUpdate(n,t.template,t.controller,a,u):f.setIfAbsent(n,t.template,t.controller,a)})})}),c.then(function(){return A.between(B),B.canceled?(p.cancel(),n):(j=R,S=b,P.params=u(b.all,b.path,b.search),P.current=_,p.commit(),e.$broadcast("$stateChangeSuccess",_,k),n)})}).then(function(){B.canceled||(B.cancel=function(){throw Error("Can't cancel transition in after handler")},A.after(B),m($))},function(t){p.cancel(),e.$broadcast("$stateChangeError",_,k,t)})}var C=new N(s),O=null,j=o,S={},P={root:o,current:o.self,params:{},"goto":function(e,t){E({state:e,params:{all:t},updateroute:!0})},lookup:function(e){return c.resolve(j,e)},reload:b,url:function(e,t){return e=d(e)?c.lookup(a(e)):j,C.buildUrl(P.current,e,t)},is:function(e){return j.is(a(e))},isActive:function(e){return j.isActive(a(e))}};return e.$on("$routeChangeSuccess",function(){var e,t=s.current;t?(e={all:t.params,path:t.pathParams,search:t.searchParams},t.state&&E({state:t.state,params:e,route:t})):E({state:o})}),e.$on("$routeUpdate",function(){var e=s.current;x(e.params,e.pathParams,e.searchParams)}),P}]}];angular.module("dotjem.routing").provider("$state",O);var j=[function(){this.$get=["$q","$injector",function(e,t){var r={},n={};return r.push=function(e,t){n[e]=t},r.clear=function(e){m(e)&&(n={}),g(e)?delete n[e]:$(e)?angular.forEach(e,function(e,t){r.clear(t)}):b(e)&&angular.forEach(e,function(e){r.clear(e)})},r.all=function(r,o){var a=[],u=[],c=e.defer();return angular.forEach(r,function(e,r){var l;u.push(r);try{r in n||(g(e)?n[r]=angular.isString(e):null!=(l=i(e))&&(n[r]=l(t,o))),a.push(n[r])}catch(s){c.reject("Could not resolve "+r)}}),e.all(a).then(function(e){var t={};angular.forEach(e,function(e,r){t[u[r]]=e}),c.resolve(t)},function(e){c.reject(e)}),c.promise},r}]}];angular.module("dotjem.routing").provider("$resolve",j),angular.module("dotjem.routing").provider("$template",h),angular.module("dotjem.routing").provider("$view",p);var S=[function(){this.$get=["$window","$rootScope","$anchorScroll","$injector",function(e,t,r,o){function a(r){return u.$current=r,"top"===r?(e.scrollTo(0,0),n):(t.$broadcast("$scrollPositionChanged",r),n)}var u=function(e){var t;m(e)?r():g(e)?a(e):null!==(t=i(e))&&a(t(o))};return u.$current="top",u}]}];angular.module("dotjem.routing").provider("$scroll",S);var P=function(){function e(e,t,r,n){this._name=e,this._fullname=t,this._parent=n,this._children={},this._self=r,this._self.$fullname=t,this._reloadOnOptional=!d(r.reloadOnSearch)||r.reloadOnSearch,this._scrollTo=this._self.scrollTo||n&&n.scrollTo||"top"}return Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullname",{get:function(){return this._fullname},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reloadOnOptional",{get:function(){return this._reloadOnOptional},set:function(e){this._reloadOnOptional=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"self",{get:function(){return x(this._self)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"route",{get:function(){return this._route},set:function(e){if(m(e))throw Error(C.routeCannotBeUndefined);this._route=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return null===this.parent?this:this._parent.root},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollTo",{get:function(){return this._scrollTo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"views",{get:function(){return this.self.views},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resolve",{get:function(){return this.self.resolve},enumerable:!0,configurable:!0}),e.prototype.add=function(e){return this._children[e.name]=e,this},e.prototype.resolveRoute=function(){return d(this.route)?this.route.route:d(this.parent)?this.parent.resolveRoute():""},e.prototype.is=function(e){return this.fullname===e||this.fullname==="root."+e},e.prototype.isActive=function(e){return this.is(e)?!0:this.parent&&this.parent.isActive(e)||!1},e}(),R=function(){function e(e){this.root=e,this.nameRegex=RegExp("^\\w+(\\.\\w+)+$"),this.siblingRegex=RegExp("^\\$node\\(([-+]?\\d+)\\)$"),this.indexRegex=RegExp("^\\[(-?\\d+)\\]$")}return e.prototype.lookup=function(e,t){for(var r=this.root,n=e.split("."),o="root"===n[0]?1:0,t=d(t)?t:0;n.length-t>o;o++){if(!(n[o]in r.children))throw Error("Could not locate '"+n[o]+"' under '"+r.fullname+"'.");r=r.children[n[o]]}return r},e.prototype.resolve=function(e,t){var r,o=this,a=this.siblingRegex.exec(t),i=e;if(a?i=this.selectSibling(Number(a[1]),i):this.nameRegex.test(t)?i=this.lookup(t):(r=t.split("/"),w(r,function(t){i=o.select(e,t,i)})),i===this.root)throw Error(C.expressionOutOfBounds);return i&&y({},i.self)||n},e.prototype.selectSibling=function(e,t){var r=[],n=0;for(w(t.parent.children,function(e){r.push(e),t.fullname===e.fullname&&(n=r.length-1)});0>e;)e+=r.length;return e=(n+e)%r.length,r[e]},e.prototype.select=function(e,t,r){if("."===t){if(e!==r)throw Error(C.invalidBrowserPathExpression);return r}if(".."===t){if(m(r.parent))throw Error(C.expressionOutOfBounds);return r.parent}if(""===t){if(e!==r)throw Error(C.invalidBrowserPathExpression);return this.root}var n=this.indexRegex.exec(t);if(n){var o=Number(n[1]),a=[];if(w(r.children,function(e){a.push(e)}),Math.abs(o)>=a.length)throw Error(C.expressionOutOfBounds);return 0>o?a[a.length+o]:a[o]}if(t in r.children)return r.children[t];throw Error(C.couldNotFindStateForPath)},e}(),_=function(){function e(){}return e.prototype.buildStateArray=function(e,t){function r(){var e={};return o.route&&w(o.route.params,function(r,n){e[n]=t[n]}),e}var n=[],o=e;do n.push({state:o,params:r()});while(o=o.parent);return n},e.prototype.compare=function(e,t,r,n,o){for(var a,i,u=this.buildStateArray(e,r||{}),c=this.buildStateArray(t,n),l=Math.max(u.length,c.length),s=!1,f=!E(r,n),h=0;l>h;h++)a=u[u.length-h-1],i=c[c.length-h-1],m(i)?c[0].isChanged=s=!0:i.isChanged=m(a)||o&&o==i.state.fullname||i.state.fullname!==a.state.fullname||!E(i.params,a.params)?s=!0:!1;return s=s||c[0].state.reloadOnOptional&&f,{array:c.reverse(),stateChanges:s,paramChanges:f}},e}(),k=function(){function e(e,t){this.routes=e,this.transitions=t}return e.prototype.createRoute=function(e,t,r,n){var o=t||"";return""!==o&&"/"===o[o.length-1]&&(o=o.substr(0,o.length-1)),"/"!==e[0]&&""!==e&&(o+="/"),o+=e,this.routes.when(o,{state:r,reloadOnSearch:n})},e.prototype.createState=function(e,t,r){var n=this,o=e.split(".").pop();d(r)&&(e=r.fullname+"."+o);var a=new P(o,e,t,r);return a.reloadOnOptional=!d(t.reloadOnSearch)||t.reloadOnSearch,d(t.route)&&(a.route=this.createRoute(t.route,r.resolveRoute(),a.fullname,a.reloadOnOptional).$route),d(t.onEnter)&&this.transitions.onEnter(a.fullname,t.onEnter),d(t.onExit)&&this.transitions.onExit(a.fullname,t.onExit),d(t.children)&&w(t.children,function(e,t){a.add(n.createState(a.fullname+"."+t,e,a))}),a},e}(),A=function(){function e(){}return e.nameValidation=/^\w+(\.\w+)*?$/,e.validateName=function(t){if(!e.nameValidation.test(t))throw Error("Invalid name: '"+t+"'.")},e}(),N=function(){function e(e){this.route=e}return e.prototype.buildUrl=function(e,t,r){var n=e;if(!t.route)throw Error("Can't build url for a state that doesn't have a url defined.");var o={},a=n&&n.$params&&n.$params.all||{};return w(t.route.params,function(e,t){t in a&&(o[t]=a[t])}),this.route.format(t.route.route,y(o,r||{}))},e}(),U=function(){function e(e){this.gotofn=e,this.canceled=!1}return e.prototype.cancel=function(){this.canceled=!0},e.prototype.goto=function(e,t){this.cancel(),this.gotofn({state:e,params:{all:t},updateroute:!0})},e}(),B=["$state","$scroll","$compile","$controller","$view","$animator",function(e,t,r,n,o,a){return{restrict:"ECA",terminal:!0,link:function(e,t,i){function u(){s&&(s.$destroy(),s=null)}function c(e){e?m.leave(t.contents(),t):t.html(""),u()}function l(a){var i,u=o.get(f);if(u&&u.template){if(u.version===g)return;g=u.version,i=u.controller,u.template.then(function(o){c(a),a?m.enter(angular.element("<div></div>").html(o).contents(),t):t.html(o);var l,f=r(t.contents());s=e.$new(),i&&(l=x(u.locals),l.$scope=s,i=n(i,l),t.contents().data("$ngControllerController",i)),f(s),s.$emit("$viewContentLoaded"),s.$eval(p)})}else g=-1,c(a)}var s,f=i.jemView||i.name,h=d(i.ngAnimate),p=i.onload||"",m=a(e,i),g=-1;e.$on("$viewChanged",function(e,t){t===f&&l(h)}),e.$on("$viewRefresh",function(e,t,r){t===f&&(v(s.refresh)?s.refresh(r):s.$broadcast("$refresh",t,r))}),e.$on("$stateChangeSuccess",function(){return l(h)}),l(!1)}}}];angular.module("dotjem.routing").directive("jemView",B);var I=["$scroll","$timeout",function(e,t){return{restrict:"ECA",terminal:!1,link:function(r,n,o){function a(e){e===i&&t(function(){n[0].scrollIntoView()},100)}var i=o.jemAnchor||o.id;r.$on("$scrollPositionChanged",function(e,t){a(t)}),a(e.$current)}}}];angular.module("dotjem.routing").directive("jemAnchor",I),r.State=P,r.StateBrowser=R,r.StateComparer=_,r.StateFactory=k,r.StateRules=A,r.StateUrlBuilder=N})(window,document,dotjem||(dotjem={}));